<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <title>–°–ø–∏—Å–æ–∫ –ø–∏—Ç–æ–º—Ü–µ–≤</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/style.css}">
    <style>
        /* –°—Å—ã–ª–∫–∏ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è/—É–¥–∞–ª–µ–Ω–∏—è ‚Äî —Å–¥–µ–ª–∞–µ–º –∏—Ö –∫–Ω–æ–ø–∫–∞–º–∏-–ø–æ–¥–æ–±–Ω—ã–º–∏ */
        .card a {
            color: var(--button-bg);
            text-decoration: none;
            font-weight: 600;
            margin-right: 10px;
            transition: color 0.3s ease;
        }
        .card a:hover {
            color: var(--button-hover);
            text-decoration: underline;
        }
        /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ */
        h1 {
            text-align: center;
            margin-bottom: 25px;
        }
        /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è */
        .add-pet-container {
            text-align: center;
            margin-bottom: 20px;
        }
        /* –ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–∏—Ç–æ–º—Ü–∞ —á—É—Ç—å –∫—Ä—É–ø–Ω–µ–µ */
        .add-pet-container button {
            font-size: 1.1rem;
            font-weight: 600;
        }
        /* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –∏ –≤—ã—Ö–æ–¥ */
        .user-info {
            text-align: center;
            margin-bottom: 15px;
            padding: 10px;
            background-color: var(--card-bg);
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        .user-info span {
            font-weight: 600;
        }
        .logout-link {
            color: var(--button-bg);
            text-decoration: none;
            font-weight: 600;
            transition: color 0.3s ease;
        }
        .logout-link:hover {
            color: var(--button-hover);
            text-decoration: underline;
        }

    </style>
</head>
<body>

<!-- Welcome message in top-left corner -->
<div class="welcome-message">
    –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, <span th:text="${userFullName}">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</span>!
</div>

<!-- Logout button to the left of theme toggle -->
<form th:action="@{/logout}" method="post" class="d-inline">
    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
    <button type="submit" class="logout-button" aria-label="–í—ã–π—Ç–∏" title="–í—ã–π—Ç–∏">üö™‚Ü©</button>
</form>

<!-- Theme toggle button -->
<button class="theme-toggle" onclick="toggleTheme()" id="themeBtn" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">üåû</button>

<!-- User controls (role badge and buttons) -->
<div class="user-controls">
    <div>
        <span sec:authorize="hasRole('ADMIN')" class="badge bg-primary">ADMIN</span>
        <span sec:authorize="hasRole('USER')" class="badge bg-secondary">USER</span>
    </div>
    <div>
        <a sec:authorize="hasRole('ADMIN')" th:href="@{/pets/admin/all}" class="btn btn-outline-primary show-all-btn">–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –∑–∞–ø–∏—Å–∏</a>
    </div>
</div>

<h1 style="margin-top: 200px; margin-bottom: 25px;">–ü–∏—Ç–æ–º—Ü—ã</h1>

<div class="add-pet-container">
    <a th:href="@{/pets/new}">
        <button class="btn btn-primary" style="background-color: var(--button-bg); border-color: var(--button-bg);">‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–∏—Ç–æ–º—Ü–∞</button>
    </a>
    <p sec:authorize="hasRole('USER')" class="pet-info-note mt-2">–í—ã –≤–∏–¥–∏—Ç–µ —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∑–∞–ø–∏—Å–∏</p>
</div>

<!-- –ö–∞—Ä—Ç–æ—á–∫–∏ -->
<div class="cards-container">
    <div class="card" th:each="pet : ${pets}">
        <h3 th:text="${pet.petName}">–ò–º—è –ø–∏—Ç–æ–º—Ü–∞</h3>
        <p><strong>–í–ª–∞–¥–µ–ª–µ—Ü:</strong> <span th:text="${pet.ownerName}"></span></p>
        <p><strong>–í–∏–¥:</strong> <span th:text="${pet.kind}"></span></p>
        <p><strong>–ü–æ—Ä–æ–¥–∞:</strong> <span th:text="${pet.species}"></span></p>
        <p><strong>–ü–æ–ª:</strong> <span th:text="${pet.gender}"></span></p>
        <p><strong>–í–æ–∑—Ä–∞—Å—Ç:</strong> <span th:text="${pet.age}"></span> –ª–µ—Ç</p>
        <div sec:authorize="hasRole('ADMIN')" class="mt-3">
            <a th:href="@{'/pets/edit/' + ${pet.id}}"
               class="btn btn-sm btn-outline-primary me-2"
               title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–∏—Ç–æ–º—Ü–∞">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
            <a th:href="@{'/pets/delete/' + ${pet.id}}"
               class="btn btn-sm btn-outline-danger"
               onclick="return confirm('–£–¥–∞–ª–∏—Ç—å –ø–∏—Ç–æ–º—Ü–∞?');"
               title="–£–¥–∞–ª–∏—Ç—å –ø–∏—Ç–æ–º—Ü–∞">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</a>
        </div>
    </div>
</div>

<script>
    // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–º—ã –∏–∑ localStorage
    document.addEventListener("DOMContentLoaded", () => {
        const isDark = localStorage.getItem("theme") === "dark";
        if (isDark) {
            document.body.classList.add("dark");
            document.getElementById("themeBtn").textContent = "üåô";
        }
    });

    function toggleTheme() {
        const body = document.body;
        const btn = document.getElementById("themeBtn");
        body.classList.toggle("dark");
        const isDark = body.classList.contains("dark");
        btn.textContent = isDark ? "üåô" : "üåû";
        localStorage.setItem("theme", isDark ? "dark" : "light");
    }
</script>

</body>
</html>